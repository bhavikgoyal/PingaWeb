
/*!
 * jquery.fancytree.js
 * Tree view control with support for lazy loading and much more.
 * https://github.com/mar10/fancytree/
 *
 * Copyright (c) 2008-2019, Martin Wendt (http://wwWendt.de)
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.30.2
 * @date 2019-01-13T08:17:01Z
 */
a=[i(0),i(184)],void 0===(r="function"==typeof(n=function(t){"use strict";if(!t.ui||!t.ui.fancytree){var e,i,n=null,a=new RegExp(/\.|\//),r=/[&<>"'\/]/g,o=/[<>"'\/]/g,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},l={16:!0,17:!0,18:!0},c={8:"backspace",9:"tab",10:"return",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},d={16:"shift",17:"ctrl",18:"alt",91:"meta",93:"meta"},u={0:"",1:"left",2:"middle",3:"right"},h="active expanded focus folder lazy radiogroup selected unselectable unselectableIgnore".split(" "),p={},f="columns types".split(" "),g="checkbox expanded extraClasses folder icon iconTooltip key lazy partsel radiogroup refKey selected statusNodeType title tooltip type unselectable unselectableIgnore unselectableStatus".split(" "),m={},v={},y={active:!0,children:!0,data:!0,focus:!0};for(e=0;e<h.length;e++)p[h[e]]=!0;for(e=0;e<g.length;e++)i=g[e],m[i]=!0,i!==i.toLowerCase()&&(v[i.toLowerCase()]=i);return b(t.ui,"Fancytree requires jQuery UI (http://jqueryui.com)"),Date.now||(Date.now=function(){return(new Date).getTime()}),E.prototype={_findDirectChild:function(t){var e,i,n=this.children;if(n)if("string"==typeof t){for(e=0,i=n.length;e<i;e++)if(n[e].key===t)return n[e]}else{if("number"==typeof t)return this.children[t];if(t.parent===this)return t}return null},_setChildren:function(t){b(t&&(!this.children||0===this.children.length),"only init supported"),this.children=[];for(var e=0,i=t.length;e<i;e++)this.children.push(new E(this,t[e]))},addChildren:function(e,i){var n,a,r,o,s=this.getFirstChild(),l=this.getLastChild(),c=[];for(t.isPlainObject(e)&&(e=[e]),this.children||(this.children=[]),n=0,a=e.length;n<a;n++)c.push(new E(this,e[n]));if(o=c[0],null==i?this.children=this.children.concat(c):(i=this._findDirectChild(i),b((r=t.inArray(i,this.children))>=0,"insertBefore must be an existing child"),this.children.splice.apply(this.children,[r,0].concat(c))),s&&!i){for(n=0,a=c.length;n<a;n++)c[n].render();s!==this.getFirstChild()&&s.renderStatus(),l!==this.getLastChild()&&l.renderStatus()}else(!this.parent||this.parent.ul||this.tr)&&this.render();return 3===this.tree.options.selectMode&&this.fixSelection3FromEndNodes(),this.triggerModifyChild("add",1===c.length?c[0]:null),o},addClass:function(t){return this.toggleClass(t,!0)},addNode:function(t,e){switch(void 0!==e&&"over"!==e||(e="child"),e){case"after":return this.getParent().addChildren(t,this.getNextSibling());case"before":return this.getParent().addChildren(t,this);case"firstChild":var i=this.children?this.children[0]:null;return this.addChildren(t,i);case"child":case"over":return this.addChildren(t)}b(!1,"Invalid mode: "+e)},addPagingNode:function(e,i){var n,a;if(i=i||"child",!1!==e)return e=t.extend({title:this.tree.options.strings.moreData,statusNodeType:"paging",icon:!1},e),this.partload=!0,this.addNode(e,i);for(n=this.children.length-1;n>=0;n--)"paging"===(a=this.children[n]).statusNodeType&&this.removeChild(a);this.partload=!1},appendSibling:function(t){return this.addNode(t,"after")},applyPatch:function(e){if(null===e)return this.remove(),S(this);var i,n,a={children:!0,expanded:!0,parent:!0};for(i in e)n=e[i],a[i]||t.isFunction(n)||(m[i]?this[i]=n:this.data[i]=n);return e.hasOwnProperty("children")&&(this.removeChildren(),e.children&&this._setChildren(e.children)),this.isVisible()&&(this.renderTitle(),this.renderStatus()),e.hasOwnProperty("expanded")?this.setExpanded(e.expanded):S(this)},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(t,e,i){return t.addNode(this.toDict(!0,i),e)},countChildren:function(t){var e,i,n,a=this.children;if(!a)return 0;if(n=a.length,!1!==t)for(e=0,i=n;e<i;e++)n+=a[e].countChildren();return n},debug:function(t){this.tree.options.debugLevel>=4&&(Array.prototype.unshift.call(arguments,this.toString()),w("log",arguments))},discard:function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},discardMarkup:function(t){var e=t?"nodeRemoveMarkup":"nodeRemoveChildMarkup";this.tree._callHook(e,this)},error:function(t){this.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),w("error",arguments))},findAll:function(e){e=t.isFunction(e)?e:L(e);var i=[];return this.visit(function(t){e(t)&&i.push(t)}),i},findFirst:function(e){e=t.isFunction(e)?e:L(e);var i=null;return this.visit(function(t){if(e(t))return i=t,!1}),i},_changeSelectStatusAttrs:function(t){var e=!1,i=this.tree.options,a=n.evalOption("unselectable",this,this,i,!1),r=n.evalOption("unselectableStatus",this,this,i,void 0);switch(a&&null!=r&&(t=r),t){case!1:e=this.selected||this.partsel,this.selected=!1,this.partsel=!1;break;case!0:e=!this.selected||!this.partsel,this.selected=!0,this.partsel=!0;break;case void 0:e=this.selected||!this.partsel,this.selected=!1,this.partsel=!0;break;default:b(!1,"invalid state: "+t)}return e&&this.renderStatus(),e},fixSelection3AfterClick:function(t){var e=this.isSelected();this.visit(function(t){t._changeSelectStatusAttrs(e)}),this.fixSelection3FromEndNodes(t)},fixSelection3FromEndNodes:function(t){var e=this.tree.options;b(3===e.selectMode,"expected selectMode 3"),function t(i){var a,r,o,s,l,c,d,u,h=i.children;if(h&&h.length){for(c=!0,d=!1,a=0,r=h.length;a<r;a++)s=t(o=h[a]),n.evalOption("unselectableIgnore",o,o,e,!1)||(!1!==s&&(d=!0),!0!==s&&(c=!1));l=!!c||!!d&&void 0}else l=null==(u=n.evalOption("unselectableStatus",i,i,e,void 0))?!!i.selected:!!u;return i._changeSelectStatusAttrs(l),l}(this),this.visitParents(function(t){var i,a,r,o,s,l=t.children,c=!0,d=!1;for(i=0,a=l.length;i<a;i++)r=l[i],n.evalOption("unselectableIgnore",r,r,e,!1)||(((o=null==(s=n.evalOption("unselectableStatus",r,r,e,void 0))?!!r.selected:!!s)||r.partsel)&&(d=!0),o||(c=!1));o=!!c||!!d&&void 0,t._changeSelectStatusAttrs(o)})},fromDict:function(e){for(var i in e)m[i]?this[i]=e[i]:"data"===i?t.extend(this.data,e.data):t.isFunction(e[i])||y[i]||(this.data[i]=e[i]);e.children&&(this.removeChildren(),this.addChildren(e.children)),this.renderTitle()},getChildren:function(){if(void 0!==this.hasChildren())return this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return t.inArray(this,this.parent.children)},getIndexHier:function(e,i){e=e||".";var n,a=[];return t.each(this.getParentList(!1,!0),function(t,e){n=""+(e.getIndex()+1),i&&(n=("0000000"+n).substr(-i)),a.push(n)}),a.join(e)},getKeyPath:function(t){var e=[],i=this.tree.options.keyPathSeparator;return this.visitParents(function(t){t.parent&&e.unshift(t.key)},!t),i+e.join(i)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},getNextSibling:function(){if(this.parent){var t,e,i=this.parent.children;for(t=0,e=i.length-1;t<e;t++)if(i[t]===this)return i[t+1]}return null},getParent:function(){return this.parent},getParentList:function(t,e){for(var i=[],n=e?this:this.parent;n;)(t||n.parent)&&i.unshift(n),n=n.parent;return i},getPrevSibling:function(){if(this.parent){var t,e,i=this.parent.children;for(t=1,e=i.length;t<e;t++)if(i[t]===this)return i[t-1]}return null},getSelectedNodes:function(t){var e=[];return this.visit(function(i){if(i.selected&&(e.push(i),!0===t))return"skip"}),e},hasChildren:function(){if(this.lazy){if(null==this.children)return;if(0===this.children.length)return!1;if(1===this.children.length&&this.children[0].isStatusNode())return;return!0}return!(!this.children||!this.children.length)},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(t){this.tree.options.debugLevel>=3&&(Array.prototype.unshift.call(arguments,this.toString()),w("info",arguments))},isActive:function(){return this.tree.activeNode===this},isBelowOf:function(t){return this.getIndexHier(".",5)>t.getIndexHier(".",5)},isChildOf:function(t){return this.parent&&this.parent===t},isDescendantOf:function(e){if(!e||e.tree!==this.tree)return!1;for(var i=this.parent;i;){if(i===e)return!0;i===i.parent&&t.error("Recursive parent link: "+i),i=i.parent}return!1},isExpanded:function(){return!!this.expanded},isFirstSibling:function(){var t=this.parent;return!t||t.children[0]===this},isFolder:function(){return!!this.folder},isLastSibling:function(){var t=this.parent;return!t||t.children[t.children.length-1]===this},isLazy:function(){return!!this.lazy},isLoaded:function(){return!this.lazy||void 0!==this.hasChildren()},isLoading:function(){return!!this._isLoading},isRoot:function(){return this.isRootNode()},isPartsel:function(){return!this.selected&&!!this.partsel},isPartload:function(){return!!this.partload},isRootNode:function(){return this.tree.rootNode===this},isSelected:function(){return!!this.selected},isStatusNode:function(){return!!this.statusNodeType},isPagingNode:function(){return"paging"===this.statusNodeType},isTopLevel:function(){return this.tree.rootNode===this.parent},isUndefined:function(){return void 0===this.hasChildren()},isVisible:function(){var t,e,i=this.getParentList(!1,!1);for(t=0,e=i.length;t<e;t++)if(!i[t].expanded)return!1;return!0},lazyLoad:function(t){return this.warn("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead."),this.load(t)},load:function(t){var e,i,n=this,a=this.isExpanded();return b(this.isLazy(),"load() requires a lazy node"),t||this.isUndefined()?(this.isLoaded()&&this.resetLazy(),!1===(i=this.tree._triggerNodeEvent("lazyLoad",this))?S(this):(b("boolean"!=typeof i,"lazyLoad event must return source in data.result"),e=this.tree._callHook("nodeLoadChildren",this,i),a?(this.expanded=!0,e.always(function(){n.render()})):e.always(function(){n.renderStatus()}),e)):S(this)},makeVisible:function(e){var i,n=this,a=[],r=new t.Deferred,o=this.getParentList(!1,!1),s=o.length,l=!(e&&!0===e.noAnimation),c=!(e&&!1===e.scrollIntoView);for(i=s-1;i>=0;i--)a.push(o[i].setExpanded(!0,e));return t.when.apply(t,a).done(function(){c?n.scrollIntoView(l).done(function(){r.resolve()}):r.resolve()}),r.promise()},moveTo:function(e,i,n){void 0===i||"over"===i?i="child":"firstChild"===i&&(e.children&&e.children.length?(i="before",e=e.children[0]):i="child");var a,r=this.parent,o="child"===i?e:e.parent;if(this!==e){if(this.parent?o.isDescendantOf(this)&&t.error("Cannot move a node to its own descendant"):t.error("Cannot move system root"),o!==r&&r.triggerModifyChild("remove",this),1===this.parent.children.length){if(this.parent===o)return;this.parent.children=this.parent.lazy?[]:null,this.parent.expanded=!1}else b((a=t.inArray(this,this.parent.children))>=0,"invalid source parent"),this.parent.children.splice(a,1);if(this.parent=o,o.hasChildren())switch(i){case"child":o.children.push(this);break;case"before":b((a=t.inArray(e,o.children))>=0,"invalid target parent"),o.children.splice(a,0,this);break;case"after":b((a=t.inArray(e,o.children))>=0,"invalid target parent"),o.children.splice(a+1,0,this);break;default:t.error("Invalid mode "+i)}else o.children=[this];n&&e.visit(n,!0),o===r?o.triggerModifyChild("move",this):o.triggerModifyChild("add",this),this.tree!==e.tree&&(this.warn("Cross-tree moveTo is experimantal!"),this.visit(function(t){t.tree=e.tree},!0)),r.isDescendantOf(o)||r.render(),o.isDescendantOf(r)||o===r||o.render()}},navigate:function(e,i){var n,a,r,o=t.ui.keyCode,s=null;function l(n){if(n){try{n.makeVisible({scrollIntoView:!1})}catch(t){}return t(n.span).is(":visible")?!1===i?n.setFocus():n.setActive():(n.debug("Navigate: skipping hidden node"),void n.navigate(e,i))}}switch(e){case o.BACKSPACE:this.parent&&this.parent.parent&&(r=l(this.parent));break;case o.HOME:this.tree.visit(function(e){if(t(e.span).is(":visible"))return r=l(e),!1});break;case o.END:this.tree.visit(function(e){t(e.span).is(":visible")&&(r=e)}),r&&(r=l(r));break;case o.LEFT:this.expanded?(this.setExpanded(!1),r=l(this)):this.parent&&this.parent.parent&&(r=l(this.parent));break;case o.RIGHT:this.expanded||!this.children&&!this.lazy?this.children&&this.children.length&&(r=l(this.children[0])):(this.setExpanded(),r=l(this));break;case o.UP:for(s=this.getPrevSibling();s&&!t(s.span).is(":visible");)s=s.getPrevSibling();for(;s&&s.expanded&&s.children&&s.children.length;)s=s.children[s.children.length-1];!s&&this.parent&&this.parent.parent&&(s=this.parent),r=l(s);break;case o.DOWN:if(this.expanded&&this.children&&this.children.length)s=this.children[0];else for(n=(a=this.getParentList(!1,!0)).length-1;n>=0;n--){for(s=a[n].getNextSibling();s&&!t(s.span).is(":visible");)s=s.getNextSibling();if(s)break}r=l(s)}return r||S()},remove:function(){return this.parent.removeChild(this)},removeChild:function(t){return this.tree._callHook("nodeRemoveChild",this,t)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},removeClass:function(t){return this.toggleClass(t,!1)},render:function(t,e){return this.tree._callHook("nodeRender",this,t,e)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},replaceWith:function(i){var n,a=this.parent,r=t.inArray(this,a.children),o=this;return b(this.isPagingNode(),"replaceWith() currently requires a paging status node"),(n=this.tree._callHook("nodeLoadChildren",this,i)).done(function(t){var i=o.children;for(e=0;e<i.length;e++)i[e].parent=a;a.children.splice.apply(a.children,[r+1,0].concat(i)),o.children=null,o.remove(),a.render()}).fail(function(){o.setExpanded()}),n},resetLazy:function(){this.removeChildren(),this.expanded=!1,this.lazy=!0,this.children=void 0,this.renderStatus()},scheduleAction:function(e,i){this.tree.timer&&(clearTimeout(this.tree.timer),this.tree.debug("clearTimeout(%o)",this.tree.timer)),this.tree.timer=null;var n=this;switch(e){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){n.tree.debug("setTimeout: trigger expand"),n.setExpanded(!0)},i);break;case"activate":this.tree.timer=setTimeout(function(){n.tree.debug("setTimeout: trigger activate"),n.setActive(!0)},i);break;default:t.error("Invalid mode "+e)}},scrollIntoView:function(e,i){if(void 0!==i&&(n=i).tree&&void 0!==n.statusNodeType)throw"scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead.";var n,a=t.extend({effects:!0===e?{duration:200,queue:!1}:e,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent,topNode:null},i),r=a.scrollParent,o=this.tree.$container,s=o.css("overflow-y");r?r.jquery||(r=t(r)):r=this.tree.tbody?o.scrollParent():"scroll"===s||"auto"===s?o:o.scrollParent(),r[0]!==document&&r[0]!==document.body||(this.debug("scrollIntoView(): normalizing scrollParent to 'window':",r[0]),r=t(window));var l,c,d,u=new t.Deferred,h=this,p=t(this.span).height(),f=a.scrollOfs.top||0,g=a.scrollOfs.bottom||0,m=r.height(),v=r.scrollTop(),y=r,w=r[0]===window,x=a.topNode||null,_=null;return t(this.span).is(":visible")?(w?(c=t(this.span).offset().top,l=x&&x.span?t(x.span).offset().top:0,y=t("html,body")):(b(r[0]!==document&&r[0]!==document.body,"scrollParent should be a simple element or `window`, not document or body."),d=r.offset().top,c=t(this.span).offset().top-d+v,l=x?t(x.span).offset().top-d+v:0,m-=Math.max(0,r.innerHeight()-r[0].clientHeight)),c<v+f?_=c-f:c+p>v+m-g&&(_=c+p-m+g,x&&(b(x.isRootNode()||t(x.span).is(":visible"),"topNode must be visible"),l<_&&(_=l-f))),null!==_?a.effects?(a.effects.complete=function(){u.resolveWith(h)},y.stop(!0).animate({scrollTop:_},a.effects)):(y[0].scrollTop=_,u.resolveWith(this)):u.resolveWith(this),u.promise()):(this.warn("scrollIntoView(): node is invisible."),S())},setActive:function(t,e){return this.tree._callHook("nodeSetActive",this,t,e)},setExpanded:function(t,e){return this.tree._callHook("nodeSetExpanded",this,t,e)},setFocus:function(t){return this.tree._callHook("nodeSetFocus",this,t)},setSelected:function(t,e){return this.tree._callHook("nodeSetSelected",this,t,e)},setStatus:function(t,e,i){return this.tree._callHook("nodeSetStatus",this,t,e,i)},setTitle:function(t){this.title=t,this.renderTitle(),this.triggerModify("rename")},sortChildren:function(t,e){var i,n,a=this.children;if(a){if(t=t||function(t,e){var i=t.title.toLowerCase(),n=e.title.toLowerCase();return i===n?0:i>n?1:-1},a.sort(t),e)for(i=0,n=a.length;i<n;i++)a[i].children&&a[i].sortChildren(t,"$norender$");"$norender$"!==e&&this.render(),this.triggerModifyChild("sort")}},toDict:function(e,i){var n,a,r,o={},s=this;if(t.each(g,function(t,e){(s[e]||!1===s[e])&&(o[e]=s[e])}),t.isEmptyObject(this.data)||(o.data=t.extend({},this.data),t.isEmptyObject(o.data)&&delete o.data),i&&i(o,s),e&&this.hasChildren())for(o.children=[],n=0,a=this.children.length;n<a;n++)(r=this.children[n]).isStatusNode()||o.children.push(r.toDict(!0,i));return o},toggleClass:function(e,i){var n,a,r=e.match(/\S+/g)||[],o=0,s=!1,l=this[this.tree.statusClassPropName],c=" "+(this.extraClasses||"")+" ";for(l&&t(l).toggleClass(e,i);n=r[o++];)if(a=c.indexOf(" "+n+" ")>=0,i=void 0===i?!a:!!i)a||(c+=n+" ",s=!0);else for(;c.indexOf(" "+n+" ")>-1;)c=c.replace(" "+n+" "," ");return this.extraClasses=t.trim(c),s},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"FancytreeNode@"+this.key+"[title='"+this.title+"']"},triggerModifyChild:function(e,i,n){var a,r=this.tree.options.modifyChild;r&&(i&&i.parent!==this&&t.error("childNode "+i+" is not a child of "+this),a={node:this,tree:this.tree,operation:e,childNode:i||null},n&&t.extend(a,n),r({type:"modifyChild"},a))},triggerModify:function(t,e){this.parent.triggerModifyChild(t,this,e)},visit:function(t,e){var i,n,a=!0,r=this.children;if(!0===e&&(!1===(a=t(this))||"skip"===a))return a;if(r)for(i=0,n=r.length;i<n&&!1!==(a=r[i].visit(t,!0));i++);return a},visitAndLoad:function(e,i,n){var a,r,o,s=this;return!e||!0!==i||!1!==(r=e(s))&&"skip"!==r?s.children||s.lazy?(a=new t.Deferred,o=[],s.load().done(function(){for(var i=0,n=s.children.length;i<n;i++){if(!1===(r=s.children[i].visitAndLoad(e,!0,!0))){a.reject();break}"skip"!==r&&o.push(r)}t.when.apply(this,o).then(function(){a.resolve()})}),a.promise()):S():n?r:S()},visitParents:function(t,e){if(e&&!1===t(this))return!1;for(var i=this.parent;i;){if(!1===t(i))return!1;i=i.parent}return!0},visitSiblings:function(t,e){var i,n,a,r=this.parent.children;for(i=0,n=r.length;i<n;i++)if(a=r[i],(e||a!==this)&&!1===t(a))return!1;return!0},warn:function(t){this.tree.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),w("warn",arguments))}},A.prototype={_makeHookContext:function(e,i,n){var a,r;return void 0!==e.node?(i&&e.originalEvent!==i&&t.error("invalid args"),a=e):e.tree?a={node:e,tree:r=e.tree,widget:r.widget,options:r.widget.options,originalEvent:i,typeInfo:r.types[e.type]||{}}:e.widget?a={node:null,tree:e,widget:e.widget,options:e.widget.options,originalEvent:i}:t.error("invalid args"),n&&t.extend(a,n),a},_callHook:function(e,i,n){var a=this._makeHookContext(i),r=this[e],o=Array.prototype.slice.call(arguments,2);return t.isFunction(r)||t.error("_callHook('"+e+"') is not a function"),o.unshift(a),r.apply(this,o)},_setExpiringValue:function(t,e,i){this._tempCache[t]={value:e,expire:Date.now()+(+i||50)}},_getExpiringValue:function(t){var e=this._tempCache[t];return e&&e.expire>Date.now()?e.value:(delete this._tempCache[t],null)},_requireExtension:function(e,i,n,a){null!=n&&(n=!!n);var r=this._local.name,o=this.options.extensions,s=t.inArray(e,o)<t.inArray(r,o),l=i&&null==this.ext[e],c=!l&&null!=n&&n!==s;return b(r&&r!==e,"invalid or same name"),!l&&!c||(a||(l||i?(a="'"+r+"' extension requires '"+e+"'",c&&(a+=" to be registered "+(n?"before":"after")+" itself")):a="If used together, `"+e+"` must be registered "+(n?"before":"after")+" `"+r+"`"),t.error(a),!1)},activateKey:function(t,e){var i=this.getNodeByKey(t);return i?i.setActive(!0,e):this.activeNode&&this.activeNode.setActive(!1,e),i},addPagingNode:function(t,e){return this.rootNode.addPagingNode(t,e)},applyPatch:function(e){var i,n,a,r,o,s,l=e.length,c=[];for(n=0;n<l;n++)b(2===(a=e[n]).length,"patchList must be an array of length-2-arrays"),r=a[0],o=a[1],(s=null===r?this.rootNode:this.getNodeByKey(r))?(i=new t.Deferred,c.push(i),s.applyPatch(o).always(C(i,s))):this.warn("could not find node with key '"+r+"'");return t.when.apply(t,c).promise()},clear:function(t){this._callHook("treeClear",this)},count:function(){return this.rootNode.countChildren()},debug:function(t){this.options.debugLevel>=4&&(Array.prototype.unshift.call(arguments,this.toString()),w("log",arguments))},enable:function(t){!1===t?this.widget.disable():this.widget.enable()},enableUpdate:function(t){return t=!1!==t,!!this._enableUpdate==!!t?t:(this._enableUpdate=t,t?(this.debug("enableUpdate(true): redraw "),this.render()):this.debug("enableUpdate(false)..."),!t)},expandAll:function(t,e){t=!1!==t,this.visit(function(i){!1!==i.hasChildren()&&i.isExpanded()!==t&&i.setExpanded(t,e)})},findAll:function(t){return this.rootNode.findAll(t)},findFirst:function(t){return this.rootNode.findFirst(t)},findNextNode:function(e,i,n){var a;e="string"==typeof e?(a=new RegExp("^"+e,"i"),function(t){return a.test(t.title)}):e,i=i||this.getFirstChild();var r=null,o=i.parent.children,s=null,l=function(t,e,i){var n,a,r=t.children,o=r.length,s=r[e];if(s&&!1===i(s))return!1;if(s&&s.children&&s.expanded&&!1===l(s,0,i))return!1;for(n=e+1;n<o;n++)if(!1===l(t,n,i))return!1;return(a=t.parent)?l(a,a.children.indexOf(t)+1,i):l(t,0,i)};return l(i.parent,o.indexOf(i),function(n){return n!==r&&(r=r||n,t(n.span).is(":visible")?(!e(n)||(s=n)===i)&&void 0:void n.debug("quicksearch: skipping hidden node"))}),s},generateFormElements:function(e,i,n){n=n||{};var a,r="string"==typeof e?e:"ft_"+this._id+"[]",o="string"==typeof i?i:"ft_"+this._id+"_active",s="fancytree_result_"+this._id,l=t("#"+s),c=3===this.options.selectMode&&!1!==n.stopOnParents;function d(e){l.append(t("<input>",{type:"checkbox",name:r,value:e.key,checked:!0}))}l.length?l.empty():l=t("<div>",{id:s}).hide().insertAfter(this.$container),!1!==i&&this.activeNode&&l.append(t("<input>",{type:"radio",name:o,value:this.activeNode.key,checked:!0})),n.filter?this.visit(function(t){var e=n.filter(t);if("skip"===e)return e;!1!==e&&d(t)}):!1!==e&&(a=this.getSelectedNodes(c),t.each(a,function(t,e){d(e)}))},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(){return this.focusNode},getOption:function(t){return this.widget.option(t)},getNodeByKey:function(t,e){var i,n;return!e&&(i=document.getElementById(this.options.idPrefix+t))?i.ftnode?i.ftnode:null:(e=e||this.rootNode,n=null,e.visit(function(e){if(e.key===t)return n=e,!1},!0),n)},getRootNode:function(){return this.rootNode},getSelectedNodes:function(t){return this.rootNode.getSelectedNodes(t)},hasFocus:function(){return!!this._hasFocus},info:function(t){this.options.debugLevel>=3&&(Array.prototype.unshift.call(arguments,this.toString()),w("info",arguments))},loadKeyPath:function(e,i){var n,a,r,o=this,s=new t.Deferred,l=this.getRootNode(),c=this.options.keyPathSeparator,d=[],u=t.extend({},i);for("function"==typeof i?n=i:i&&i.callback&&(n=i.callback),u.callback=function(t,e,i){n&&n.call(t,e,i),s.notifyWith(t,[{node:e,status:i}])},null==u.matchKey&&(u.matchKey=function(t,e){return t.key===e}),t.isArray(e)||(e=[e]),a=0;a<e.length;a++)(r=e[a]).charAt(0)===c&&(r=r.substr(1)),d.push(r.split(c));return setTimeout(function(){o._loadKeyPathImpl(s,u,l,d).done(function(){s.resolve()})},0),s.promise()},_loadKeyPathImpl:function(e,i,n,a){var r,o,s,l,c,d,u,h,p=this;function f(t,e){var n,a,r=t.children;if(r)for(n=0,a=r.length;n<a;n++)if(i.matchKey(r[n],e))return r[n];return null}for(c={},o=0;o<a.length;o++)for(u=a[o],d=n;u.length;){if(s=u.shift(),!(l=f(d,s))){this.warn("loadKeyPath: key not found: "+s+" (parent: "+d+")"),i.callback(this,s,"error");break}if(0===u.length){i.callback(this,l,"ok");break}if(l.lazy&&void 0===l.hasChildren()){i.callback(this,l,"loaded"),c[s=l.key]?c[s].pathSegList.push(u):c[s]={parent:l,pathSegList:[u]};break}i.callback(this,l,"loaded"),d=l}function g(t,e,n){i.callback(p,e,"loading"),e.load().done(function(){p._loadKeyPathImpl.call(p,t,i,e,n).always(C(t,p))}).fail(function(n){p.warn("loadKeyPath: error loading lazy "+e),i.callback(p,l,"error"),t.rejectWith(p)})}for(var m in r=[],c){var v=c[m];h=new t.Deferred,r.push(h),g(h,v.parent,v.pathSegList)}return t.when.apply(t,r).promise()},reactivate:function(t){var e,i=this.activeNode;return i?(this.activeNode=null,e=i.setActive(!0,{noFocus:!0}),t&&i.setFocus(),e):S()},reload:function(t){return this._callHook("treeClear",this),this._callHook("treeLoad",this,t)},render:function(t,e){return this.rootNode.render(t,e)},selectAll:function(t){this.visit(function(e){e.setSelected(t)})},setFocus:function(t){return this._callHook("treeSetFocus",this,t)},setOption:function(t,e){return this.widget.option(t,e)},toDict:function(t,e){var i=this.rootNode.toDict(!0,e);return t?i:i.children},toString:function(){return"Fancytree@"+this._id},_triggerNodeEvent:function(t,e,i,n){var a=this._makeHookContext(e,i,n),r=this.widget._trigger(t,i,a);return!1!==r&&void 0!==a.result?a.result:r},_triggerTreeEvent:function(t,e,i){var n=this._makeHookContext(this,e,i),a=this.widget._trigger(t,e,n);return!1!==a&&void 0!==n.result?n.result:a},visit:function(t){return this.rootNode.visit(t,!1)},visitRows:function(t,e){if(e&&e.reverse)return delete e.reverse,this._visitRowsUp(t,e);var i,n,a,r=0,o=!1===e.includeSelf,s=!!e.includeHidden,l=e.start||this.rootNode.children[0];for(n=l.parent;n;){for(i=(a=n.children).indexOf(l)+r;i<a.length;i++){if(l=a[i],!o&&!1===t(l))return!1;if(o=!1,l.children&&l.children.length&&(s||l.expanded)&&!1===l.visit(function(e){return!1!==t(e)&&(s||!e.children||e.expanded?void 0:"skip")},!1))return!1}l=n,n=n.parent,r=1}return!0},_visitRowsUp:function(e,i){for(var n,a,r,o=!!i.includeHidden,s=i.start||this.rootNode.children[0];;){if((n=(r=s.parent).children)[0]===s)s=r,n=r.children;else for(a=n.indexOf(s),s=n[a-1];(o||s.expanded)&&s.children&&s.children.length;)r=s,s=(n=s.children)[n.length-1];if((o||t(s.span).is(":visible"))&&!1===e(s))return!1}},warn:function(t){this.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),w("warn",arguments))}},t.extend(A.prototype,{nodeClick:function(t){var e,i,n=t.targetType,a=t.node;if("expander"===n){if(a.isLoading())return void a.debug("Got 2nd click while loading: ignored");this._callHook("nodeToggleExpanded",t)}else if("checkbox"===n)this._callHook("nodeToggleSelected",t),t.options.focusOnSelect&&this._callHook("nodeSetFocus",t,!0);else{if(i=!1,e=!0,a.folder)switch(t.options.clickFolderMode){case 2:i=!0,e=!1;break;case 3:e=!0,i=!0}e&&(this.nodeSetFocus(t),this._callHook("nodeSetActive",t,!0)),i&&this._callHook("nodeToggleExpanded",t)}},nodeCollapseSiblings:function(t,e){var i,n,a,r=t.node;if(r.parent)for(n=0,a=(i=r.parent.children).length;n<a;n++)i[n]!==r&&i[n].expanded&&this._callHook("nodeSetExpanded",i[n],!1,e)},nodeDblclick:function(t){"title"===t.targetType&&4===t.options.clickFolderMode&&this._callHook("nodeToggleExpanded",t),"title"===t.targetType&&t.originalEvent.preventDefault()},nodeKeydown:function(e){var i,a,r,o=e.originalEvent,s=e.node,l=e.tree,u=e.options,h=o.which,p=o.key||String.fromCharCode(h),f=!!(o.altKey||o.ctrlKey||o.metaKey),g=!d[h]&&!c[h]&&!f,m=t(o.target),v=!0,y=!(o.ctrlKey||!u.autoActivate);if(s||(r=this.getActiveNode()||this.getFirstChild())&&(r.setFocus(),(s=e.node=this.focusNode).debug("Keydown force focus on active node")),u.quicksearch&&g&&!m.is(":input:enabled"))return(a=Date.now())-l.lastQuicksearchTime>500&&(l.lastQuicksearchTerm=""),l.lastQuicksearchTime=a,l.lastQuicksearchTerm+=p,(i=l.findNextNode(l.lastQuicksearchTerm,l.getActiveNode()))&&i.setActive(),void o.preventDefault();switch(n.eventToString(o)){case"+":case"=":l.nodeSetExpanded(e,!0);break;case"-":l.nodeSetExpanded(e,!1);break;case"space":s.isPagingNode()?l._triggerNodeEvent("clickPaging",e,o):n.evalOption("checkbox",s,s,u,!1)?l.nodeToggleSelected(e):l.nodeSetActive(e,!0);break;case"return":l.nodeSetActive(e,!0);break;case"home":case"end":case"backspace":case"left":case"right":case"up":case"down":s.navigate(o.which,y);break;default:v=!1}v&&o.preventDefault()},nodeLoadChildren:function(e,i){var n,a,r,o=e.tree,s=e.node,l=Date.now();if(t.isFunction(i)&&(i=i.call(o,{type:"source"},e),b(!t.isFunction(i),"source callback must not return another function")),i.url&&(s._requestId&&s.warn("Recursive load request #"+l+" while #"+s._requestId+" is pending."),n=t.extend({},e.options.ajax,i),s._requestId=l,n.debugDelay?(a=n.debugDelay,delete n.debugDelay,t.isArray(a)&&(a=a[0]+Math.random()*(a[1]-a[0])),s.warn("nodeLoadChildren waiting debugDelay "+Math.round(a)+" ms ..."),r=t.Deferred(function(e){setTimeout(function(){t.ajax(n).done(function(){e.resolveWith(this,arguments)}).fail(function(){e.rejectWith(this,arguments)})},a)})):r=t.ajax(n),i=new t.Deferred,r.done(function(n,a,r){var c,d;if("json"!==this.dataType&&"jsonp"!==this.dataType||"string"!=typeof n||t.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),s._requestId&&s._requestId>l)i.rejectWith(this,["$recursive_request"]);else{if(e.options.postProcess){try{d=o._triggerNodeEvent("postProcess",e,e.originalEvent,{response:n,error:null,dataType:this.dataType})}catch(t){d={error:t,message:""+t,details:"postProcess failed"}}if(d.error)return c=t.isPlainObject(d.error)?d.error:{message:d.error},c=o._makeHookContext(s,null,c),void i.rejectWith(this,[c]);(t.isArray(d)||t.isPlainObject(d)&&t.isArray(d.children))&&(n=d)}else n&&n.hasOwnProperty("d")&&e.options.enableAspx&&(n="string"==typeof n.d?t.parseJSON(n.d):n.d);i.resolveWith(this,[n])}}).fail(function(t,e,n){var a=o._makeHookContext(s,null,{error:t,args:Array.prototype.slice.call(arguments),message:n,details:t.status+": "+n});i.rejectWith(this,[a])})),t.isFunction(i.then)&&t.isFunction(i.catch)&&(r=i,i=new t.Deferred,r.then(function(t){i.resolve(t)},function(t){i.reject(t)})),t.isFunction(i.promise))o.nodeSetStatus(e,"loading"),i.done(function(t){o.nodeSetStatus(e,"ok"),s._requestId=null}).fail(function(t){var i;"$recursive_request"!==t?(t.node&&t.error&&t.message?i=t:"[object Object]"===(i=o._makeHookContext(s,null,{error:t,args:Array.prototype.slice.call(arguments),message:t?t.message||t.toString():""})).message&&(i.message=""),s.warn("Load children failed ("+i.message+")",i),!1!==o._triggerNodeEvent("loadError",i,null)&&o.nodeSetStatus(e,"error",i.message,i.details)):s.warn("Ignored response for obsolete load request #"+l+" (expected #"+s._requestId+")")});else if(e.options.postProcess){var c=o._triggerNodeEvent("postProcess",e,e.originalEvent,{response:i,error:null,dataType:typeof i});(t.isArray(c)||t.isPlainObject(c)&&t.isArray(c.children))&&(i=c)}return t.when(i).done(function(i){var n,a;t.isPlainObject(i)&&(b(s.isRootNode(),"source may only be an object for root nodes (expecting an array of child objects otherwise)"),b(t.isArray(i.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),n=i,i=i.children,delete n.children,t.each(f,function(t,e){void 0!==n[e]&&(o[e]=n[e],delete n[e])}),t.extend(o.data,n)),b(t.isArray(i),"expected array of children"),s._setChildren(i),o.options.nodata&&0===i.length&&(t.isFunction(o.options.nodata)?a=o.options.nodata.call(o,{type:"nodata"},e):!0===o.options.nodata&&s.isRootNode()?a=o.options.strings.nodata:"string"==typeof o.options.nodata&&s.isRootNode()&&(a=o.options.nodata),a&&s.setStatus("nodata",a)),o._triggerNodeEvent("loadChildren",s)})},nodeLoadKeyPath:function(t,e){},nodeRemoveChild:function(e,i){var n,a=e.node,r=t.extend({},e,{node:i}),o=a.children;if(1===o.length)return b(i===o[0],"invalid single child"),this.nodeRemoveChildren(e);this.activeNode&&(i===this.activeNode||this.activeNode.isDescendantOf(i))&&this.activeNode.setActive(!1),this.focusNode&&(i===this.focusNode||this.focusNode.isDescendantOf(i))&&(this.focusNode=null),this.nodeRemoveMarkup(r),this.nodeRemoveChildren(r),b((n=t.inArray(i,o))>=0,"invalid child"),a.triggerModifyChild("remove",i),i.visit(function(t){t.parent=null},!0),this._callHook("treeRegisterNode",this,!1,i),o.splice(n,1)},nodeRemoveChildMarkup:function(e){var i=e.node;i.ul&&(i.isRootNode()?t(i.ul).empty():(t(i.ul).remove(),i.ul=null),i.visit(function(t){t.li=t.ul=null}))},nodeRemoveChildren:function(e){var i=e.tree,n=e.node;n.children&&(this.activeNode&&this.activeNode.isDescendantOf(n)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(n)&&(this.focusNode=null),this.nodeRemoveChildMarkup(e),t.extend({},e),n.triggerModifyChild("remove",null),n.visit(function(t){t.parent=null,i._callHook("treeRegisterNode",i,!1,t)}),n.lazy?n.children=[]:n.children=null,n.isRootNode()||(n.expanded=!1),this.nodeRenderStatus(e))},nodeRemoveMarkup:function(e){var i=e.node;i.li&&(t(i.li).remove(),i.li=null),this.nodeRemoveChildMarkup(e)},nodeRender:function(e,i,n,a,r){var o,s,l,c,d,u,h,p=e.node,f=e.tree,g=e.options,m=g.aria,v=!1,y=p.parent,w=!y,x=p.children,_=null;if(!1!==f._enableUpdate&&(w||y.ul)){if(b(w||y.ul,"parent UL must exist"),w||(p.li&&(i||p.li.parentNode!==p.parent.ul)&&(p.li.parentNode===p.parent.ul?_=p.li.nextSibling:this.debug("Unlinking "+p+" (must be child of "+p.parent+")"),this.nodeRemoveMarkup(e)),p.li?this.nodeRenderStatus(e):(v=!0,p.li=document.createElement("li"),p.li.ftnode=p,p.key&&g.generateIds&&(p.li.id=g.idPrefix+p.key),p.span=document.createElement("span"),p.span.className="fancytree-node",m&&!p.tr&&t(p.li).attr("role","treeitem"),p.li.appendChild(p.span),this.nodeRenderTitle(e),g.createNode&&g.createNode.call(f,{type:"createNode"},e)),g.renderNode&&g.renderNode.call(f,{type:"renderNode"},e)),x){if(w||p.expanded||!0===n){for(p.ul||(p.ul=document.createElement("ul"),(!0!==a||r)&&p.expanded||(p.ul.style.display="none"),m&&t(p.ul).attr("role","group"),p.li?p.li.appendChild(p.ul):p.tree.$div.append(p.ul)),c=0,d=x.length;c<d;c++)h=t.extend({},e,{node:x[c]}),this.nodeRender(h,i,n,!1,!0);for(o=p.ul.firstChild;o;)(l=o.ftnode)&&l.parent!==p?(p.debug("_fixParent: remove missing "+l,o),u=o.nextSibling,o.parentNode.removeChild(o),o=u):o=o.nextSibling;for(o=p.ul.firstChild,c=0,d=x.length-1;c<d;c++)(s=x[c])!==(l=o.ftnode)?p.ul.insertBefore(s.li,l.li):o=o.nextSibling}}else p.ul&&(this.warn("remove child markup for "+p),this.nodeRemoveChildMarkup(e));w||v&&y.ul.insertBefore(p.li,_)}},nodeRenderTitle:function(e,i){var r,o,s,l,c,d,u,h=e.node,p=e.tree,f=e.options,g=f.aria,m=h.getLevel(),v=[];void 0!==i&&(h.title=i),h.span&&!1!==p._enableUpdate&&(c=g&&!1!==h.hasChildren()?" role='button'":"",m<f.minExpandLevel?(h.lazy||(h.expanded=!0),m>1&&v.push("<span "+c+" class='fancytree-expander fancytree-expander-fixed'></span>")):v.push("<span "+c+" class='fancytree-expander'></span>"),(r=n.evalOption("checkbox",h,h,f,!1))&&!h.isStatusNode()&&(c=g?" role='checkbox'":"",o="fancytree-checkbox",("radio"===r||h.parent&&h.parent.radiogroup)&&(o+=" fancytree-radio"),v.push("<span "+c+" class='"+o+"'></span>")),void 0!==h.data.iconClass&&(h.icon?t.error("'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead"):(h.warn("'iconClass' node option is deprecated since v2.14.0: use 'icon' instead"),h.icon=h.data.iconClass)),!1!==(s=n.evalOption("icon",h,h,f,!0))&&(c=g?" role='presentation'":"",u=(u=n.evalOption("iconTooltip",h,h,f,null))?" title='"+D(u)+"'":"","string"==typeof s?a.test(s)?(s="/"===s.charAt(0)?s:(f.imagePath||"")+s,v.push("<img src='"+s+"' class='fancytree-icon'"+u+" alt='' />")):v.push("<span "+c+" class='fancytree-custom-icon "+s+"'"+u+"></span>"):s.text?v.push("<span "+c+" class='fancytree-custom-icon "+(s.addClass||"")+"'"+u+">"+n.escapeHtml(s.text)+"</span>"):s.html?v.push("<span "+c+" class='fancytree-custom-icon "+(s.addClass||"")+"'"+u+">"+s.html+"</span>"):v.push("<span "+c+" class='fancytree-icon'"+u+"></span>")),l="",f.renderTitle&&(l=f.renderTitle.call(p,{type:"renderTitle"},e)||""),l||(!0===(d=n.evalOption("tooltip",h,h,f,null))&&(d=h.title),l="<span class='fancytree-title'"+(d=d?" title='"+D(d)+"'":"")+(f.titlesTabbable?" tabindex='0'":"")+">"+(f.escapeTitles?n.escapeHtml(h.title):h.title)+"</span>"),v.push(l),h.span.innerHTML=v.join(""),this.nodeRenderStatus(e),f.enhanceTitle&&(e.$title=t(">span.fancytree-title",h.span),l=f.enhanceTitle.call(p,{type:"enhanceTitle"},e)||""))},nodeRenderStatus:function(e){var i,a=e.node,r=e.tree,o=e.options,s=a.hasChildren(),l=a.isLastSibling(),c=o.aria,d=o._classNames,u=[],h=a[r.statusClassPropName];h&&!1!==r._enableUpdate&&(c&&(i=t(a.tr||a.li)),u.push(d.node),r.activeNode===a&&u.push(d.active),r.focusNode===a&&u.push(d.focused),a.expanded&&u.push(d.expanded),c&&(!1!==s?i.attr("aria-expanded",Boolean(a.expanded)):i.removeAttr("aria-expanded")),a.folder&&u.push(d.folder),!1!==s&&u.push(d.hasChildren),l&&u.push(d.lastsib),a.lazy&&null==a.children&&u.push(d.lazy),a.partload&&u.push(d.partload),a.partsel&&u.push(d.partsel),n.evalOption("unselectable",a,a,o,!1)&&u.push(d.unselectable),a._isLoading&&u.push(d.loading),a._error&&u.push(d.error),a.statusNodeType&&u.push(d.statusNodePrefix+a.statusNodeType),a.selected?(u.push(d.selected),c&&i.attr("aria-selected",!0)):c&&i.attr("aria-selected",!1),a.extraClasses&&u.push(a.extraClasses),!1===s?u.push(d.combinedExpanderPrefix+"n"+(l?"l":"")):u.push(d.combinedExpanderPrefix+(a.expanded?"e":"c")+(a.lazy&&null==a.children?"d":"")+(l?"l":"")),u.push(d.combinedIconPrefix+(a.expanded?"e":"c")+(a.folder?"f":"")),h.className=u.join(" "),a.li&&t(a.li).toggleClass(d.lastsib,l))},nodeSetActive:function(e,i,n){n=n||{};var a,r=e.node,o=e.tree,s=e.options,l=!0===n.noEvents,c=!0===n.noFocus,d=!1!==n.scrollIntoView;return r===o.activeNode==(i=!1!==i)?S(r):i&&!l&&!1===this._triggerNodeEvent("beforeActivate",r,e.originalEvent)?M(r,["rejected"]):(i?(o.activeNode&&(b(o.activeNode!==r,"node was active (inconsistency)"),a=t.extend({},e,{node:o.activeNode}),o.nodeSetActive(a,!1),b(null===o.activeNode,"deactivate was out of sync?")),s.activeVisible&&r.makeVisible({scrollIntoView:d}),o.activeNode=r,o.nodeRenderStatus(e),c||o.nodeSetFocus(e),l||o._triggerNodeEvent("activate",r,e.originalEvent)):(b(o.activeNode===r,"node was not active (inconsistency)"),o.activeNode=null,this.nodeRenderStatus(e),l||e.tree._triggerNodeEvent("deactivate",r,e.originalEvent)),S(r))},nodeSetExpanded:function(e,i,n){n=n||{};var a,r,o,s,l,c,d=e.node,u=e.tree,h=e.options,p=!0===n.noAnimation,f=!0===n.noEvents;if(i=!1!==i,d.expanded&&i||!d.expanded&&!i)return S(d);if(i&&!d.lazy&&!d.hasChildren())return S(d);if(!i&&d.getLevel()<h.minExpandLevel)return M(d,["locked"]);if(!f&&!1===this._triggerNodeEvent("beforeExpand",d,e.originalEvent))return M(d,["rejected"]);if(p||d.isVisible()||(p=n.noAnimation=!0),r=new t.Deferred,i&&!d.expanded&&h.autoCollapse){l=d.getParentList(!1,!0),c=h.autoCollapse;try{for(h.autoCollapse=!1,o=0,s=l.length;o<s;o++)this._callHook("nodeCollapseSiblings",l[o],n)}finally{h.autoCollapse=c}}return r.done(function(){var t=d.getLastChild();i&&h.autoScroll&&!p&&t?t.scrollIntoView(!0,{topNode:d}).always(function(){f||e.tree._triggerNodeEvent(i?"expand":"collapse",e)}):f||e.tree._triggerNodeEvent(i?"expand":"collapse",e)}),a=function(n){var a=h._classNames,r=h.toggleEffect;if(d.expanded=i,u._callHook("nodeRender",e,!1,!1,!0),d.ul)if("none"!==d.ul.style.display==!!d.expanded)d.warn("nodeSetExpanded: UL.style.display already set");else{if(r&&!p)return t(d.li).addClass(a.animating),void(t.isFunction(t(d.ul)[r.effect])?(u.debug("use jquery."+r.effect+" method"),t(d.ul)[r.effect]({duration:r.duration,always:function(){t(this).removeClass(a.animating),t(d.li).removeClass(a.animating),n()}})):(t(d.ul).stop(!0,!0),t(d.ul).parent().find(".ui-effects-placeholder").remove(),t(d.ul).toggle(r.effect,r.options,r.duration,function(){t(this).removeClass(a.animating),t(d.li).removeClass(a.animating),n()})));d.ul.style.display=d.expanded||!parent?"":"none"}n()},i&&d.lazy&&void 0===d.hasChildren()?d.load().done(function(){r.notifyWith&&r.notifyWith(d,["loaded"]),a(function(){r.resolveWith(d)})}).fail(function(t){a(function(){r.rejectWith(d,["load failed ("+t+")"])})}):a(function(){r.resolveWith(d)}),r.promise()},nodeSetFocus:function(e,i){var n,a=e.tree,r=e.node,o=a.options,s=!!e.originalEvent&&t(e.originalEvent.target).is(":input");if(i=!1!==i,a.focusNode){if(a.focusNode===r&&i)return;n=t.extend({},e,{node:a.focusNode}),a.focusNode=null,this._triggerNodeEvent("blur",n),this._callHook("nodeRenderStatus",n)}i&&(this.hasFocus()||(r.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",e,!0,{calledByNode:!0})),r.makeVisible({scrollIntoView:!1}),a.focusNode=r,o.titlesTabbable?s||t(r.span).find(".fancytree-title").focus():0===t(document.activeElement).closest(".fancytree-container").length&&t(a.$container).focus(),o.aria&&t(a.$container).attr("aria-activedescendant",t(r.tr||r.li).uniqueId().attr("id")),this._triggerNodeEvent("focus",e),o.autoScroll&&r.scrollIntoView(),this._callHook("nodeRenderStatus",e))},nodeSetSelected:function(t,e,i){i=i||{};var a=t.node,r=t.tree,o=t.options,s=!0===i.noEvents,l=a.parent;if(e=!1!==e,!n.evalOption("unselectable",a,a,o,!1)){if(a._lastSelectIntent=e,!!a.selected===e&&(3!==o.selectMode||!a.partsel||e))return e;if(!s&&!1===this._triggerNodeEvent("beforeSelect",a,t.originalEvent))return!!a.selected;e&&1===o.selectMode?(r.lastSelectedNode&&r.lastSelectedNode.setSelected(!1),a.selected=e):3!==o.selectMode||!l||l.radiogroup||a.radiogroup?l&&l.radiogroup?a.visitSiblings(function(t){t._changeSelectStatusAttrs(e&&t===a)},!0):a.selected=e:(a.selected=e,a.fixSelection3AfterClick(i)),this.nodeRenderStatus(t),r.lastSelectedNode=e?a:null,s||r._triggerNodeEvent("select",t)}},nodeSetStatus:function(e,i,n,a){var r=e.node,o=e.tree;function s(e,i){var n=r.children?r.children[0]:null;return n&&n.isStatusNode()?(t.extend(n,e),n.statusNodeType=i,o._callHook("nodeRenderTitle",n)):(r._setChildren([e]),r.children[0].statusNodeType=i,o.render()),r.children[0]}switch(i){case"ok":!function(){var t=r.children?r.children[0]:null;if(t&&t.isStatusNode()){try{r.ul&&(r.ul.removeChild(t.li),t.li=null)}catch(t){}1===r.children.length?r.children=[]:r.children.shift()}}(),r._isLoading=!1,r._error=null,r.renderStatus();break;case"loading":r.parent||s({title:o.options.strings.loading+(n?" ("+n+")":""),checkbox:!1,tooltip:a},i),r._isLoading=!0,r._error=null,r.renderStatus();break;case"error":s({title:o.options.strings.loadError+(n?" ("+n+")":""),checkbox:!1,tooltip:a},i),r._isLoading=!1,r._error={message:n,details:a},r.renderStatus();break;case"nodata":s({title:n||o.options.strings.noData,checkbox:!1,tooltip:a},i),r._isLoading=!1,r._error=null,r.renderStatus();break;default:t.error("invalid node status "+i)}},nodeToggleExpanded:function(t){return this.nodeSetExpanded(t,!t.node.expanded)},nodeToggleSelected:function(t){var e=t.node,i=!e.selected;return e.partsel&&!e.selected&&!0===e._lastSelectIntent&&(i=!1,e.selected=!0),e._lastSelectIntent=i,this.nodeSetSelected(t,i)},treeClear:function(t){var e=t.tree;e.activeNode=null,e.focusNode=null,e.$div.find(">ul.fancytree-container").empty(),e.rootNode.children=null},treeCreate:function(t){},treeDestroy:function(t){this.$div.find(">ul.fancytree-container").remove(),this.$source&&this.$source.removeClass("fancytree-helper-hidden")},treeInit:function(e){var i=e.tree,n=i.options;i.$container.attr("tabindex",n.tabindex),t.each(f,function(t,e){void 0!==n[e]&&(i.info("Move option "+e+" to tree"),i[e]=n[e],delete n[e])}),n.rtl?i.$container.attr("DIR","RTL").addClass("fancytree-rtl"):i.$container.removeAttr("DIR").removeClass("fancytree-rtl"),n.aria&&(i.$container.attr("role","tree"),1!==n.selectMode&&i.$container.attr("aria-multiselectable",!0)),this.treeLoad(e)},treeLoad:function(e,i){var n,a,r,o=e.tree,s=e.widget.element,l=t.extend({},e,{node:this.rootNode});if(o.rootNode.children&&this.treeClear(e),i=i||this.options.source)"string"==typeof i&&t.error("Not implemented");else switch(a=s.data("type")||"html"){case"html":(r=s.find(">ul:first")).addClass("ui-fancytree-source fancytree-helper-hidden"),i=t.ui.fancytree.parseHtml(r),this.data=t.extend(this.data,T(r));break;case"json":i=t.parseJSON(s.text()),s.contents().filter(function(){return 3===this.nodeType}).remove(),t.isPlainObject(i)&&(b(t.isArray(i.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),n=i,i=i.children,delete n.children,t.each(f,function(t,e){void 0!==n[e]&&(o[e]=n[e],delete n[e])}),t.extend(o.data,n));break;default:t.error("Invalid data-type: "+a)}return this.nodeLoadChildren(l,i).done(function(){o.render(),3===e.options.selectMode&&o.rootNode.fixSelection3FromEndNodes(),o.activeNode&&o.options.activeVisible&&o.activeNode.makeVisible(),o._triggerTreeEvent("init",null,{status:!0})}).fail(function(){o.render(),o._triggerTreeEvent("init",null,{status:!1})})},treeRegisterNode:function(t,e,i){},treeSetFocus:function(e,i,n){var a;(i=!1!==i)!==this.hasFocus()&&(this._hasFocus=i,!i&&this.focusNode?this.focusNode.setFocus(!1):!i||n&&n.calledByNode||t(this.$container).focus(),this.$container.toggleClass("fancytree-treefocus",i),this._triggerTreeEvent(i?"focusTree":"blurTree"),i&&!this.activeNode&&(a=this._lastMousedownNode||this.getFirstChild())&&a.setFocus())},treeSetOption:function(e,i,n){var a=e.tree,r=!0,o=!1,s=!1;switch(i){case"aria":case"checkbox":case"icon":case"minExpandLevel":case"tabindex":o=!0,s=!0;break;case"escapeTitles":case"tooltip":s=!0;break;case"rtl":!1===n?a.$container.removeAttr("DIR").removeClass("fancytree-rtl"):a.$container.attr("DIR","RTL").addClass("fancytree-rtl"),s=!0;break;case"source":r=!1,a._callHook("treeLoad",a,n),s=!0}a.debug("set option "+i+"="+n+" <"+typeof n+">"),r&&(this.widget._super?this.widget._super.call(this.widget,i,n):t.Widget.prototype._setOption.call(this.widget,i,n)),o&&a._callHook("treeCreate",a),s&&a.render(!0,!1)}}),t.widget("ui.fancytree",{options:{activeVisible:!0,ajax:{type:"GET",cache:!1,dataType:"json"},aria:!0,autoActivate:!0,autoCollapse:!1,autoScroll:!1,checkbox:!1,clickFolderMode:4,debugLevel:null,disabled:!1,enableAspx:!0,escapeTitles:!1,extensions:[],toggleEffect:{effect:"slideToggle",duration:200},generateIds:!1,icon:!0,idPrefix:"ft_",focusOnSelect:!1,keyboard:!0,keyPathSeparator:"/",minExpandLevel:1,nodata:!0,quicksearch:!1,rtl:!1,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading...",loadError:"Load error!",moreData:"More...",noData:"No data."},tabindex:"0",titlesTabbable:!1,tooltip:!1,_classNames:{node:"fancytree-node",folder:"fancytree-folder",animating:"fancytree-animating",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",hasChildren:"fancytree-has-children",active:"fancytree-active",selected:"fancytree-selected",expanded:"fancytree-expanded",lazy:"fancytree-lazy",focused:"fancytree-focused",partload:"fancytree-partload",partsel:"fancytree-partsel",radio:"fancytree-radio",unselectable:"fancytree-unselectable",lastsib:"fancytree-lastsib",loading:"fancytree-loading",error:"fancytree-error",statusNodePrefix:"fancytree-statusnode-"},lazyLoad:null,postProcess:null},_create:function(){this.tree=new A(this),this.$source=this.source||"json"===this.element.data("type")?this.element:this.element.find(">ul:first");var e,i,n,a=this.options,r=a.extensions;this.tree;for(n=0;n<r.length;n++)i=r[n],(e=t.ui.fancytree._extensions[i])||t.error("Could not apply extension '"+i+"' (it is not registered, did you forget to include it?)"),this.tree.options[i]=x({},e.options,this.tree.options[i]),b(void 0===this.tree.ext[i],"Extension name must not exist as Fancytree.ext attribute: '"+i+"'"),this.tree.ext[i]={},k(this.tree,0,e,i),e;void 0!==a.icons&&(!0!==a.icon?t.error("'icons' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'icons' tree option is deprecated since v2.14.0: use 'icon' instead"),a.icon=a.icons)),void 0!==a.iconClass&&(a.icon?t.error("'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead"),a.icon=a.iconClass)),void 0!==a.tabbable&&(a.tabindex=a.tabbable?"0":"-1",this.tree.warn("'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='"+a.tabindex+"' instead")),this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree),this._bind()},_setOption:function(t,e){return this.tree._callHook("treeSetOption",this.tree,t,e)},destroy:function(){this._unbind(),this.tree._callHook("treeDestroy",this.tree),t.Widget.prototype.destroy.call(this)},_unbind:function(){var e=this.tree._ns;this.element.off(e),this.tree.$container.off(e),t(document).off(e)},_bind:function(){var e=this,i=this.options,a=this.tree,r=a._ns;this._unbind(),a.$container.on("focusin"+r+" focusout"+r,function(e){var i=n.getNode(e),r="focusin"===e.type;if(!r&&i&&t(e.target).is("a"))i.debug("Ignored focusout on embedded <a> element.");else{if(r){if(a._getExpiringValue("focusin"))return void a.debug("Ignored double focusin.");a._setExpiringValue("focusin",!0,50),i||(i=a._getExpiringValue("mouseDownNode"))&&a.debug("Reconstruct mouse target for focusin from recent event.")}i?a._callHook("nodeSetFocus",a._makeHookContext(i,e),r):a.tbody&&t(e.target).parents("table.fancytree-container > thead").length?a.debug("Ignore focus event outside table body.",e):a._callHook("treeSetFocus",a,r)}}).on("selectstart"+r,"span.fancytree-title",function(t){t.preventDefault()}).on("keydown"+r,function(t){if(i.disabled||!1===i.keyboard)return!0;var e,n=a.focusNode,r=a._makeHookContext(n||a,t),o=a.phase;try{return a.phase="userEvent","preventNav"===(e=n?a._triggerNodeEvent("keydown",n,t):a._triggerTreeEvent("keydown",t))?e=!0:!1!==e&&(e=a._callHook("nodeKeydown",r)),e}finally{a.phase=o}}).on("mousedown"+r,function(t){var e=n.getEventTarget(t);a._lastMousedownNode=e?e.node:null,a._setExpiringValue("mouseDownNode",a._lastMousedownNode)}).on("click"+r+" dblclick"+r,function(t){if(i.disabled)return!0;var a,r=n.getEventTarget(t),o=r.node,s=e.tree,l=s.phase;if(!o)return!0;a=s._makeHookContext(o,t);try{switch(s.phase="userEvent",t.type){case"click":return a.targetType=r.type,o.isPagingNode()?!0===s._triggerNodeEvent("clickPaging",a,t):!1!==s._triggerNodeEvent("click",a,t)&&s._callHook("nodeClick",a);case"dblclick":return a.targetType=r.type,!1!==s._triggerNodeEvent("dblclick",a,t)&&s._callHook("nodeDblclick",a)}}finally{s.phase=l}})},getActiveNode:function(){return this.tree.activeNode},getNodeByKey:function(t){return this.tree.getNodeByKey(t)},getRootNode:function(){return this.tree.rootNode},getTree:function(){return this.tree}}),n=t.ui.fancytree,t.extend(t.ui.fancytree,{version:"2.30.2",buildType:"production",debugLevel:3,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:A,_FancytreeNodeClass:E,jquerySupports:{positionMyOfs:function(e,i,n,a){var r,o,s,l=t.map(t.trim(e).split("."),function(t){return parseInt(t,10)}),c=t.map(Array.prototype.slice.call(arguments,1),function(t){return parseInt(t,10)});for(r=0;r<c.length;r++)if(o=l[r]||0,s=c[r]||0,o!==s)return o>s;return!0}(t.ui.version,1,9)},assert:function(t,e){return b(t,e)},createTree:function(e,i){return t(e).fancytree(i).fancytree("getTree")},debounce:function(t,e,i,n){var a;return 3===arguments.length&&"boolean"!=typeof i&&(n=i,i=!1),function(){var r=arguments;n=n||this,i&&!a&&e.apply(n,r),clearTimeout(a),a=setTimeout(function(){i||e.apply(n,r),a=null},t)}},debug:function(e){t.ui.fancytree.debugLevel>=4&&w("log",arguments)},error:function(e){t.ui.fancytree.debugLevel>=1&&w("error",arguments)},escapeHtml:function(t){return(""+t).replace(r,function(t){return s[t]})},fixPositionOptions:function(e){if((e.offset||(""+e.my+e.at).indexOf("%")>=0)&&t.error("expected new position syntax (but '%' is not supported)"),!t.ui.fancytree.jquerySupports.positionMyOfs){var i=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(e.my),n=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(e.at),a=(i[2]?+i[2]:0)+(n[2]?+n[2]:0),r=(i[4]?+i[4]:0)+(n[4]?+n[4]:0);e=t.extend({},e,{my:i[1]+" "+i[3],at:n[1]+" "+n[3]}),(a||r)&&(e.offset=a+" "+r)}return e},getEventTarget:function(e){var i,a=e&&e.target?e.target.className:"",r={node:this.getNode(e.target),type:void 0};return/\bfancytree-title\b/.test(a)?r.type="title":/\bfancytree-expander\b/.test(a)?r.type=!1===r.node.hasChildren()?"prefix":"expander":/\bfancytree-checkbox\b/.test(a)?r.type="checkbox":/\bfancytree(-custom)?-icon\b/.test(a)?r.type="icon":/\bfancytree-node\b/.test(a)?r.type="title":e&&e.target&&((i=t(e.target)).is("ul[role=group]")?((r.node&&r.node.tree||n).debug("Ignoring click on outer UL."),r.node=null):i.closest(".fancytree-title").length?r.type="title":i.closest(".fancytree-checkbox").length?r.type="checkbox":i.closest(".fancytree-expander").length&&(r.type="expander")),r},getEventTargetType:function(t){return this.getEventTarget(t).type},getNode:function(e){if(e instanceof E)return e;for(e instanceof t?e=e[0]:void 0!==e.originalEvent&&(e=e.target);e;){if(e.ftnode)return e.ftnode;e=e.parentNode}return null},getTree:function(e){var i;return e instanceof A?e:(void 0===e&&(e=0),"number"==typeof e?e=t(".fancytree-container").eq(e):"string"==typeof e?e=t(e).eq(0):e instanceof t?e=e.eq(0):void 0!==e.originalEvent&&(e=t(e.target)),(i=(e=e.closest(":ui-fancytree")).data("ui-fancytree")||e.data("fancytree"))?i.tree:null)},evalOption:function(e,i,n,a,r){var o,s,l=i.tree,c=a[e],d=n[e];return t.isFunction(c)?(o={node:i,tree:l,widget:l.widget,options:l.widget.options,typeInfo:l.types[i.type]||{}},null==(s=c.call(l,{type:e},o))&&(s=d)):s=null!=d?d:c,null==s&&(s=r),s},setSpanIcon:function(e,i,n){var a=t(e);"string"==typeof n?a.attr("class",i+" "+n):(n.text?a.text(""+n.text):n.html&&(e.innerHTML=n.html),a.attr("class",i+" "+(n.addClass||"")))},eventToString:function(t){var e=t.which,i=t.type,n=[];return t.altKey&&n.push("alt"),t.ctrlKey&&n.push("ctrl"),t.metaKey&&n.push("meta"),t.shiftKey&&n.push("shift"),"click"===i||"dblclick"===i?n.push(u[t.button]+i):l[e]||n.push(c[e]||String.fromCharCode(e).toLowerCase()),n.join("+")},info:function(e){t.ui.fancytree.debugLevel>=3&&w("info",arguments)},keyEventToString:function(t){return this.warn("keyEventToString() is deprecated: use eventToString()"),this.eventToString(t)},overrideMethod:function(e,i,n,a){var r,o=e[i]||t.noop;e[i]=function(){var t=a||this;try{return r=t._super,t._super=o,n.apply(t,arguments)}finally{t._super=r}}},parseHtml:function(e){var i,n,a,r,o,s,l,c,d=e.find(">li"),u=[];return d.each(function(){var d,f,m=t(this),y=m.find(">span:first",this),b=y.length?null:m.find(">a:first"),w={tooltip:null,data:{}};for(y.length?w.title=y.html():b&&b.length?(w.title=b.html(),w.data.href=b.attr("href"),w.data.target=b.attr("target"),w.tooltip=b.attr("title")):(w.title=m.html(),(o=w.title.search(/<ul/i))>=0&&(w.title=w.title.substring(0,o))),w.title=t.trim(w.title),r=0,s=h.length;r<s;r++)w[h[r]]=void 0;for(i=this.className.split(" "),a=[],r=0,s=i.length;r<s;r++)n=i[r],p[n]?w[n]=!0:a.push(n);if(w.extraClasses=a.join(" "),(l=m.attr("title"))&&(w.tooltip=l),(l=m.attr("id"))&&(w.key=l),m.attr("hideCheckbox")&&(w.checkbox=!1),(d=T(m))&&!t.isEmptyObject(d)){for(f in v)d.hasOwnProperty(f)&&(d[v[f]]=d[f],delete d[f]);for(r=0,s=g.length;r<s;r++)l=g[r],null!=(c=d[l])&&(delete d[l],w[l]=c);t.extend(w.data,d)}(e=m.find(">ul:first")).length?w.children=t.ui.fancytree.parseHtml(e):w.children=w.lazy?void 0:null,u.push(w)}),u},registerExtension:function(e){b(null!=e.name,"extensions must have a `name` property."),b(null!=e.version,"extensions must have a `version` property."),t.ui.fancytree._extensions[e.name]=e},unescapeHtml:function(t){var e=document.createElement("div");return e.innerHTML=t,0===e.childNodes.length?"":e.childNodes[0].nodeValue},warn:function(e){t.ui.fancytree.debugLevel>=2&&w("warn",arguments)}}),t.ui.fancytree}function b(e,i){e||(i=i?": "+i:"",t.error("Fancytree assertion failed"+i))}function w(t,e){var i,n,a=window.console?window.console[t]:null;if(a)try{a.apply(window.console,e)}catch(t){for(n="",i=0;i<e.length;i++)n+=e[i];a(n)}}function x(){var e,i,n,a,r,o=arguments[0]||{},s=1,l=arguments.length;if("object"==typeof o||t.isFunction(o)||(o={}),s===l)throw"need at least two args";for(;s<l;s++)if(null!=(e=arguments[s]))for(i in e)n=o[i],a=e[i],o!==a&&(a&&t.isPlainObject(a)?(r=n&&t.isPlainObject(n)?n:{},o[i]=x(r,a)):void 0!==a&&(o[i]=a));return o}function _(t,e,i,n,a){var r,o,s,l,c,d=(r=e[t],o=n[t],s=e.ext[a],l=function(){return r.apply(e,arguments)},c=function(t){return r.apply(e,t)},function(){var t=e._local,i=e._super,n=e._superApply;try{return e._local=s,e._super=l,e._superApply=c,o.apply(e,arguments)}finally{e._local=t,e._super=i,e._superApply=n}});return d}function k(e,i,n,a){for(var r in n)"function"==typeof n[r]?"function"==typeof e[r]?e[r]=_(r,e,0,n,a):"_"===r.charAt(0)?e.ext[a][r]=_(r,e,0,n,a):t.error("Could not override tree."+r+". Use prefix '_' to create tree."+a+"._"+r):"options"!==r&&(e.ext[a][r]=n[r])}function S(e,i){return void 0===e?t.Deferred(function(){this.resolve()}).promise():t.Deferred(function(){this.resolveWith(e,i)}).promise()}function M(e,i){return void 0===e?t.Deferred(function(){this.reject()}).promise():t.Deferred(function(){this.rejectWith(e,i)}).promise()}function C(t,e){return function(){t.resolveWith(e)}}function T(e){var i=t.extend({},e.data()),n=i.json;return delete i.fancytree,delete i.uiFancytree,n&&(delete i.json,i=t.extend(i,n)),i}function D(t){return(""+t).replace(o,function(t){return s[t]})}function L(t){return t=t.toLowerCase(),function(e){return e.title.toLowerCase().indexOf(t)>=0}}function E(e,i){var a,r,o,s;for(this.parent=e,this.tree=e.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},a=0,r=g.length;a<r;a++)this[o=g[a]]=i[o];for(o in null==this.unselectableIgnore&&null==this.unselectableStatus||(this.unselectable=!0),i.hideCheckbox&&t.error("'hideCheckbox' node option was removed in v2.23.0: use 'checkbox: false'"),i.data&&t.extend(this.data,i.data),i)m[o]||t.isFunction(i[o])||y[o]||(this.data[o]=i[o]);null==this.key?this.tree.options.defaultKey?(this.key=this.tree.options.defaultKey(this),b(this.key,"defaultKey() must return a unique key")):this.key="_"+n._nextNodeKey++:this.key=""+this.key,i.active&&(b(null===this.tree.activeNode,"only one active node allowed"),this.tree.activeNode=this),i.selected&&(this.tree.lastSelectedNode=this),(s=i.children)?s.length?this._setChildren(s):this.children=this.lazy?[]:null:this.children=null,this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function A(e){this.widget=e,this.$div=e.element,this.options=e.options,this.options&&(t.isFunction(this.options.lazyload)&&!t.isFunction(this.options.lazyLoad)&&(this.options.lazyLoad=function(){return n.warn("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),e.options.lazyload.apply(this,arguments)}),t.isFunction(this.options.loaderror)&&t.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),void 0!==this.options.fx&&n.warn("The 'fx' option was replaced by 'toggleEffect' since 2014-11-30."),void 0!==this.options.removeNode&&t.error("The 'removeNode' event was replaced by 'modifyChild' since 2.20 (2016-09-10).")),this.ext={},this.types={},this.columns={},this.data=T(this.$div),this._id=t.ui.fancytree._nextId++,this._ns=".fancytree-"+this._id,this.activeNode=null,this.focusNode=null,this._hasFocus=null,this._tempCache={},this._lastMousedownNode=null,this._enableUpdate=!0,this.lastSelectedNode=null,this.systemFocusElement=null,this.lastQuicksearchTerm="",this.lastQuicksearchTime=0,this.statusClassPropName="span",this.ariaPropName="li",this.nodeContainerAttrName="li",this.$div.find(">ul.fancytree-container").remove();var i,a={tree:this};this.rootNode=new E(a,{title:"root",key:"root_"+this._id,children:null,expanded:!0}),this.rootNode.parent=null,i=t("<ul>",{class:"ui-fancytree fancytree-container fancytree-plain"}).appendTo(this.$div),this.$container=i,this.rootNode.ul=i[0],null==this.options.debugLevel&&(this.options.debugLevel=n.debugLevel)}t.ui.fancytree.warn("Fancytree: ignored duplicate include")})?n.apply(e,a):n)||(t.exports=r)},function(t,e,i){var n,a,r;

